<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMS Opt-In - Sister Missionary Meal Calendar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
    <%- include('../partials/navigation', { activePage: 'text' }) %>
    <%- include('../partials/sms-notice') %>

    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h4 class="mb-0">ðŸ“± SMS Opt-In for Meal Notifications</h4>
                    </div>
                    <div class="card-body">
                        <!-- Current Status Notice -->
                        <div class="alert alert-info border-primary mb-4">
                            <h5 class="alert-heading">
                                <i class="fas fa-info-circle"></i> Current Service Status
                            </h5>
                            <p class="mb-2">
                                <strong>We're building a compliant SMS notification system!</strong> 
                                While you can opt-in now to prepare for automated notifications, 
                                please note that meal coordination messages are currently being sent manually.
                            </p>
                            <ul class="mb-2">
                                <li>Your opt-in consent is being collected for when the automated system goes live</li>
                                <li>Sister missionaries will continue to receive manual text notifications about meals</li>
                                <li>Families will receive manual reminders about meal assignments</li>
                            </ul>
                            <p class="mb-0">
                                <small class="text-muted">
                                    <i class="fas fa-clock"></i> 
                                    We expect the automated SMS system to be operational shortly. 
                                    Thank you for your patience!
                                </small>
                            </p>
                        </div>
                        <% if (success) { %>
                            <div class="alert alert-success">
                                <i class="fas fa-check-circle"></i> <%= success %>
                            </div>
                        <% } %>
                        
                        <% if (error) { %>
                            <div class="alert alert-danger">
                                <i class="fas fa-exclamation-triangle"></i> <%= error %>
                            </div>
                        <% } %>

                        <div class="mb-4">
                            <h5>About SMS Notifications</h5>
                            <p class="text-muted">
                                By opting in to SMS notifications, you will receive text messages about:
                            </p>
                            <ul class="text-muted">
                                <li><strong>Meal Reminders:</strong> Notifications about upcoming meal assignments</li>
                                <li><strong>Schedule Updates:</strong> Changes to meal times or delivery preferences</li>
                                <li><strong>Volunteer Requests:</strong> Opportunities to help with meal coordination</li>
                                <li><strong>Important Announcements:</strong> Ward meal program updates</li>
                            </ul>
                            <div class="alert alert-info">
                                <small>
                                    <strong>New to the system?</strong> If your phone number isn't in our records yet, 
                                    we'll create a basic contact record for you when you opt in.
                                    <br><br>
                                    <strong>Privacy Notice:</strong> Your phone number will only be used for meal coordination. 
                                    You can opt out at any time by visiting this page or texting STOP to any message.
                                    Standard message and data rates may apply.
                                </small>
                            </div>
                        </div>

                        <form method="POST" action="/text/opt-in">
                            <div class="mb-3">
                                <label for="fullName" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="fullName" name="fullName" required
                                       placeholder="Enter your full name">
                            </div>

                            <div class="mb-3">
                                <label for="phoneNumber" class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber" 
                                       value="<%= phoneNumber %>" required
                                       placeholder="(555) 123-4567">
                                <div class="form-text">Enter your phone number. If you're new to the system, we'll create a contact record for you.</div>
                            </div>

                            <div class="mb-3">
                                <label for="contactType" class="form-label">I am a:</label>
                                <select class="form-select" id="contactType" name="contactType" required>
                                    <option value="">Select your role</option>
                                    <option value="family">Ward Family (Meal Provider)</option>
                                    <option value="missionary">Sister Missionary</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="consent" required>
                                    <label class="form-check-label" for="consent">
                                        I consent to receiving SMS notifications for meal coordination purposes. 
                                        I understand I can opt out at any time.
                                    </label>
                                </div>
                            </div>

                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-success btn-lg">
                                    ðŸ“± Opt In to SMS Notifications
                                </button>
                            </div>
                        </form>

                        <hr class="my-4">

                        <div class="text-center">
                            <p class="text-muted mb-2">Already receiving messages and want to opt out?</p>
                            <a href="/text/opt-out" class="btn btn-outline-secondary">
                                Opt Out of SMS Notifications
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-light text-center py-3 mt-5">
        <div class="container">
            <p class="text-muted mb-0">Sister Missionary Meal Calendar - Ward Meal Coordination System</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
